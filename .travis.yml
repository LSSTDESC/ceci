language: python

python:
  - "3.6"
  - "3.7"
  - "3.8"

install:
  - python setup.py install
  # For parsl
  - pip install flask parsl==0.8.0
  # for CWL
  - pip install cwlgen==0.4 cwltool==2.0.20200126090152
  # For code coverage testing
  - pip install codecov pytest-cov

# Test three different pipelines
script:
  - export PYTHONPATH=$PYTHONPATH:$PWD
  # These tests are actually repeated in the
  # pytest below, but it's useful to check the CLI works.
  - ceci test/test.yml
  - ceci --dry-run test/test.yml
  - ceci test/test.yml launcher.name=parsl launcher.max_threads=3
  - ceci test/test.yml launcher.name=cwl launcher.dir=test/cwl launcher.launch=cwltool
  - pytest --cov=ceci

after_success:
    - codecov
